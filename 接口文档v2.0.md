# 接口文档 V2.0

- 实际测试将截图中的localhost 换为 http://8.130.164.184 

- 1. 修改接口：
> 注册接口没有任何改变，登录接口在data中保留用户id
- 2. 新增接口：
> 用户信息查询(解密版)
> 用户信息更新
> 简历上传
- 3. notice:
> 更换了加密方式，服务器数据库有改动目前可用的两条数据为：
>> 求职者：
-- 插入user
insert into user(id, name, nickname, phone, email, address, password, birth_year, min_expected_salary, max_expected_salary, ideal_city, education, type, school, major)
  values (2285096803,
          AES_ENCRYPT('杜素宁','name_secret_key','AES/CBC/PKCS5Padding'),
          '老杜',
          AES_ENCRYPT('15904130130','phone_secret_key','AES/CBC/PKCS5Padding'),
          AES_ENCRYPT('0da08x@163.com','email_secret_key','AES/CBC/PKCS5Padding'),
          AES_ENCRYPT('云南省昭通市','address_secret_key','AES/CBC/PKCS5Padding'),
          AES_ENCRYPT('580044','password_secret_key','AES/CBC/PKCS5Padding'),
          2000,'6K','8K','成都','本科','全日制','北方工业大学','计算机科学与技术');
-------
>> 招聘者：
-- employer表操作
insert into employer(name, duty, phone, email, password) VALUES
                    (AES_ENCRYPT('周尔强','name_secret_key','AES/CBC/PKCS5Padding'),
                     '嵌入式工程师',
                     AES_ENCRYPT('15523332333','phone_secret_key','AES/CBC/PKCS5Padding'),
                     AES_ENCRYPT('qiangge@qq.com','email_secret_key','AES/CBC/PKCS5Padding'),
                     AES_ENCRYPT('123456','password_secret_key','AES/CBC/PKCS5Padding'));
- 也可先注册，保留用户信息后进行其他接口测试

## 1. 通用接口

### 1.1 注册

#### 1.1.1 求职者注册

##### 1.1.1.1 基本信息
> 请求路径：/user/register/{name}/{email}/{phone}/{password}
>
> 请求方式：POST
>
> 接口描述：该接口用于求职者输入用户注册的必要信息


##### 1.1.1.2 请求参数
参数格式：路径参数

参数说明：

| 参数名 | 类型   | 是否必须 | 备注   |
| ------ | ------ | -------- | ------ |
| name     | byte[] | 必须     | 姓名 |
| email     | byte[] | 必须     | 邮箱 |
| phone     | byte[] | 必须     | 电话 |
| password     | byte[] | 必须     | 密码 |

请求参数样例：

```
localhost:8080/user/register/张三/test@qq.com/15988882346/123456
```

##### 响应数据
参数格式：application/json

参数说明：

| 参数名         | 类型   | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| code           | number | 必须     | 响应码，1 代表成功，0 代表失败 |
| msg            | string | 必须   | 提示信息                       |
| data           | object | 必须   | 返回的数据                     |
| \|- password         | byte[] | 必须   | 密码                             |
| \|- name       | byte[] | 必须   | 姓名                       |
| \|- mobile | byte[] | 必须   | 电话                       |
| \|- email | byte[] | 必须   | 邮箱                       |

响应数据样例：

```json
{
    "code": 1,
    "msg": "success",
    "data": {
        "password": "MTIzNDU2",
        "name": "5byg5LiJ",
        "mobile": "MTU5ODg4ODIzNDY=",
        "email": "dGVzdEBxcS5jb20="
    }
}
```

- 注：由于使用数据库加密，因此几个数据使用了byte[]存储，返回的json内容也有点奇怪

#### 1.1.2 招聘者注册

##### 1.1.2.1 基本信息
> 请求路径：/employer/register/{name}/{email}/{company}/{password}
>
> 请求方式：POST
>
> 接口描述：该接口用于招聘者输入用户注册的必要信息


##### 1.1.2.2 请求参数
参数格式：路径参数

参数说明：

| 参数名 | 类型   | 是否必须 | 备注   |
| ------ | ------ | -------- | ------ |
| name     | byte[] | 必须     | 姓名 |
| email     | byte[] | 必须     | 邮箱 |
| company     | string | 必须     | 公司名称 |
| password     | byte[] | 必须     | 密码 |

请求参数样例：

```
localhost:8080/employer/register/周尔强/qiangge@qq.com/电科编译研究所/123456
```

##### 响应数据
参数格式：application/json

参数说明：

| 参数名         | 类型   | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| code           | number | 必须     | 响应码，1 代表成功，0 代表失败 |
| msg            | string | 必须   | 提示信息                       |
| data           | object | 必须   | 返回的数据                     |
| \|- password         | byte[] | 必须   | 密码                             |
| \|- name       | byte[] | 必须   | 姓名                       |
| \|- company | string | 必须   | 公司名称                       |
| \|- email | byte[] | 必须   | 邮箱                       |

响应数据样例：

```json
{
    "code": 1,
    "msg": "success",
    "data": {
        "password": "MTIzNDU2",
        "name": "5ZGo5bCU5by6",
        "company": "电科编译研究所",
        "email": "cWlhbmdnZUBxcS5jb20="
    }
}
```

### 1.2 登录
- 说明：json中的data中的token问jwt令牌，type:0对应求职者，1对应招聘者
id为求职者或招聘者的ID

#### 基本信息
> 请求路径：/login/{phoneOrEmail}/{password}
>
> 请求方式：POST
>
> 接口描述：该接口用于输入用户登录的必要信息，系统自行判断用户身份

#### 请求参数
参数格式：路径参数

参数说明：

| 参数名 | 类型   | 是否必须 | 备注   |
| ------ | ------ | -------- | ------ |
| phoneOrEmail     | byte[] | 必须     | 账号信息 |
| password     | byte[] | 必须     | 密码 |


请求参数样例：
- 招聘者（针对注册时的操作只设置了邮箱方式，晚上才想起来可以编辑信息，很容易改）

```
localhost:8080/login/qiangge@qq.com/123456
```
- 求职者
``````
localhost:8080/login/15904130130/580044
``````
``````
localhost:8080/login/test@qq.com/123456
``````

##### 响应数据
参数格式：application/json

参数说明：

| 参数名         | 类型   | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| code           | number | 必须     | 响应码，1 代表成功，0 代表失败 |
| msg            | string | 必须   | 提示信息                       |
| data           | object | 必须   | 返回的数据                     |
| \|- type         | int | 必须   | 求职者or招聘者                             |
| \|- jwt       | string | 必须   | 令牌                       |


响应数据样例：

1. 求职者登录：
localhost:8080/login/15904130130/580044 对应：

```json
{
    "code": 1,
    "msg": "success",
    "data": {
        "id": 2285096803,
        "type": 0,
        "token": "eyJhbGciOiJIUzI1NiJ9.eyJpZCI6MjI4NTA5NjgwMywiZXhwIjoxNzA3MDEzNDIzfQ.1j30ONq3y936JwbKhLztiSbJXF0jcKHajXamp9Ufqlg"
    }
}
```
localhost:8080/login/test@qq.com/123456 对应：
- 无数据或超时，令牌时限12h

```json
{
    "code": 0,
    "msg": "无相关账号或令牌过期",
    "data": null
}
```
2. 招聘者登录：
localhost:8080/login/qiangge@qq.com/123456 对应：
``````
{
    "code": 1,
    "msg": "success",
    "data": {
        "id": 5,
        "type": 1,
        "token": "eyJhbGciOiJIUzI1NiJ9.eyJpZCI6NSwiZXhwIjoxNzA3MDE1MzczfQ.Rq8sp6dm4xqaILuATLfZLRFmA7d3Q2uBkfFRkrDWrGo"
    }
}
``````
- jwt令牌将监督后续用户的登录情况和时限，后续操作将全部基于登录
- 服务器数据库id可能和localhost不一样

### 1.3 查看个人信息（根据ID）

#### 1.3.1 求职者
##### 基本信息
> 请求路径：/user/{id}
>
> 请求方式：POST
>
> 

##### 请求参数
参数格式：路径参数

参数说明：

| 参数名 | 类型   | 是否必须 | 备注   |
| ------ | ------ | -------- | ------ |
| id     | Long | 必须     | 用户ID |


##### 样例截图
<a href="https://imgse.com/i/pFlEXIP"><img src="https://s11.ax1x.com/2024/02/03/pFlEXIP.jpg" alt="pFlEXIP.jpg" border="0" /></a>

返回信息：
``````
{
    "code": 1,
    "msg": "success",
    "data": {
        "id": 2285096803,
        "nickname": "Mr.Du",
        "birthYear": 2000,
        "minExpectedSalary": "6K",
        "maxExpectedSalary": "8K",
        "idealCity": "成都",
        "education": "本科",
        "type": "全日制",
        "school": "北方工业大学",
        "major": "计算机科学与技术",
        "name": "杜素宁",
        "phone": "15904130130",
        "email": "0da08x@163.com",
        "address": "云南省昭通市",
        "password": "580044",
        "characterType": 0,
        "resume": null
    }
}
``````

不带令牌token样式及响应：
<a href="https://imgse.com/i/pFlExG8"><img src="https://s11.ax1x.com/2024/02/03/pFlExG8.jpg" alt="pFlExG8.jpg" border="0" /></a>

token错误：
<a href="https://imgse.com/i/pFlV9MQ"><img src="https://s11.ax1x.com/2024/02/03/pFlV9MQ.jpg" alt="pFlV9MQ.jpg" border="0" /></a>

- 令牌不正确，过期，不带令牌响应结果均相同

#### 1.3.2 招聘者
##### 基本信息
> 请求路径：/employer/{id}
>
> 请求方式：POST
>
> 

##### 请求参数
参数格式：路径参数

参数说明：

| 参数名 | 类型   | 是否必须 | 备注   |
| ------ | ------ | -------- | ------ |
| id     | Long | 必须     | 用户ID |


##### 样例截图
<a href="https://imgse.com/i/pFlVAI0"><img src="https://s11.ax1x.com/2024/02/03/pFlVAI0.jpg" alt="pFlVAI0.jpg" border="0" /></a>

返回数据：
``````
{
    "code": 1,
    "msg": "success",
    "data": {
        "id": 5,
        "duty": "嵌入式工程师",
        "pid": null,
        "company": null,
        "name": "周尔强",
        "phone": "15523332333",
        "email": "qiangge@qq.com",
        "password": "123456",
        "charaterType": 1
    }
}
``````

### 1.4 修改用户信息


<font color=Red size=6>涉及简历上传后的文件托管问题，目前可以实现的逻辑为：用户先上传文件，前端进行渲染，之后点击类似“确定”的按钮，这个按钮对应的就是确认信息修改完成，也就是说必须先上传文件后提交修改信息的PUT请求</font>
类似参考：
<a href="https://imgse.com/i/pFleoxU"><img src="https://s11.ax1x.com/2024/02/04/pFleoxU.jpg" alt="pFleoxU.jpg" border="0" /></a>
<a href="https://imgse.com/i/pFle7MF"><img src="https://s11.ax1x.com/2024/02/04/pFle7MF.jpg" alt="pFle7MF.jpg" border="0" /></a>

##### 基本信息
求职者：
> 请求路径：/user/{id}
>
> 请求方式：PUT
>
> 

##### 请求参数
参数格式：路径参数

参数说明：

| 参数名 | 类型   | 是否必须 | 备注   |
| ------ | ------ | -------- | ------ |
| id     | Long | 必须     | 用户ID |


##### 样例截图
求职者：
<a href="https://imgse.com/i/pFlVJJK"><img src="https://s11.ax1x.com/2024/02/03/pFlVJJK.jpg" alt="pFlVJJK.jpg" border="0" /></a>

<a href="https://imgse.com/i/pFlVYRO"><img src="https://s11.ax1x.com/2024/02/03/pFlVYRO.jpg" alt="pFlVYRO.jpg" border="0" /></a>

返回数据：
``````
{
    "code": 1,
    "msg": "success",
    "data": null
}
``````

招聘者：
<a href="https://imgse.com/i/pFlVRyQ"><img src="https://s11.ax1x.com/2024/02/03/pFlVRyQ.jpg" alt="pFlVRyQ.jpg" border="0" /></a>
<a href="https://imgse.com/i/pFlV4wn"><img src="https://s11.ax1x.com/2024/02/03/pFlV4wn.jpg" alt="pFlV4wn.jpg" border="0" /></a>

返回：
``````
{
    "code": 1,
    "msg": "success",
    "data": null
}
``````

### 1.5 文件上传

#### 1.5.1 基本信息

> 请求路径：/upload
>
> 请求方式：POST
>
> 接口描述：上传图片接口



#### 2.6.2 请求参数

参数格式：multipart/form-data

参数说明：

| 参数名称 | 参数类型 | 是否必须 | 示例 | 备注 |
| -------- | -------- | -------- | ---- | ---- |
| resume    | file     | 是       |      |      |



#### 2.6.3 响应数据

参数格式：application/json

参数说明：

| 参数名 | 类型   | 是否必须 | 备注                           |
| ------ | ------ | -------- | ------------------------------ |
| code   | number | 必须     | 响应码，1 代表成功，0 代表失败 |
| msg    | string | 非必须   | 提示信息                       |
| data   | object | 非必须   | 返回的数据，上传简历的访问路径 |

响应数据样例：

```json
{
    "code": 1,
    "msg": "success",
    "data": "https://web-framework.oss-cn-hangzhou.aliyuncs.com/2022-09-02-00-27-0400.jpg"
}
```

及：
POST请求： localhost:8080/upload
headers输入jwt token
body 输入form-data: Key：resume , Value: 从本地选择文件

- 目前返回数据对应的云托管被我设置为private，因此直接点击访问可能只有我能看到，设成公共读有风险
